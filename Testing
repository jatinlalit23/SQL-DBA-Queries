SELECT  
    sp.name AS login_name,  
    sp.type_desc AS login_type,  
    LOGINPROPERTY(sp.name, 'LastLogonTime') AS last_login_time,  
    es.host_name,  
    ec.client_net_address AS login_source  
FROM sys.server_principals sp  
LEFT JOIN sys.dm_exec_sessions es  
    ON sp.name = es.login_name  
LEFT JOIN sys.dm_exec_connections ec  
    ON es.session_id = ec.session_id  
WHERE sp.type IN ('S', 'U', 'G')  
ORDER BY last_login_time DESC;
